<!DOCTYPE html>
<head>
    <script type="module">
        import init, {Solution} from "./pkg/day_05.js";
        await init();

        document.getElementById("part1button").addEventListener("click", function() {
            var solution = Solution.new(document.getElementById("input").value);

            var part1 = solution.render(document, document.getElementById("target"));
            function tick() {
                part1.tick_part1(tick);
            }
            tick();
        })

    </script>
    <style>
        #target {
            height: calc((var(--count) + 2) * 2em);
            position: relative;
        }

        #target > div {
            width: calc(2em - 2px);
            height: calc(2em - 2px);
            box-sizing: border-box;
            border: 2px solid black;
            text-align: center;

            position: absolute;
            top: calc((var(--count) + 1 - var(--index)) * 2em);
            left: calc(var(--stack) * 2em);
        }

        #target > div > span {
            vertical-align: middle;
            line-height: 2em;
        }

        @keyframes crane {
            33% {
                top: 0;
                left: calc(var(--stack) * 2em);
            }

            67% {
                top: 0;
                left: calc(var(--newStack) * 2em);
            }

            to {
                top: calc((var(--count) + 1 - var(--newIndex)) * 2em);
                left: calc(var(--newStack) * 2em);
            }
        }

        .moving {
            animation: 1s crane both;
            animation-delay: 100ms;
            background-color: #500;
            color: #fff;
        }
    </style>
</head>
<body>
    <h1>Day 5</h1>
    <form>
        <p>
            <textarea id="input" rows="10" cols="60">
    [D]    
[N] [C]    
[Z] [M] [P]
 1   2   3 

move 1 from 2 to 1
move 3 from 1 to 3
move 2 from 2 to 1
move 1 from 1 to 2</textarea>
        </p>
        <p>
            <input id="part1button" type="button" value="Part 1!">
        </p>
    </form>

    <div id="target"></div>

    <hr><!-- just here to visibly see that I set #target's height correctly -->
</body>
