<!DOCTYPE html>
<head>
    <script type="module">
        import init, {Solution} from "./pkg/day_05.js";
        await init();

        document.getElementById("runbutton").addEventListener("click", function() {
            var solution = Solution.new(document.getElementById("input").value);

            var part1 = solution.part1(document, document.getElementById("target"));
            function tick() {
                part1.tick(tick);
            }
            tick();
        })

    </script>
    <style>
        #target {
            height: calc((var(--count) + 2) * 2em);
            position: relative;
        }

        #target > div {
            width: calc(2em - 2px);
            height: calc(2em - 2px);
            box-sizing: border-box;
            border: 2px solid black;
            text-align: center;

            position: absolute;
            top: calc((var(--count) + 1 - var(--index)) * 2em);
            left: calc(var(--stack) * 2em);
        }

        #target > div > span {
            vertical-align: middle;
            line-height: 2em;
        }

        @keyframes crane {
            33% {
                background-color: #500;
                color: #fff;
                top: 0;
                left: calc(var(--stack) * 2em);
            }

            67% {
                top: 0;
                left: calc(var(--newStack) * 2em);
            }

            to {
                top: calc((var(--count) + 1 - var(--newIndex)) * 2em);
                left: calc(var(--newStack) * 2em);
            }
        }

        .moving {
            animation: 1s crane both;
            animation-delay: 1s;
            background-color: #500;
            color: #fff;
        }
    </style>
</head>
<body>
    <h1>lol</h1>
    <form>
        <p>
            <textarea id="input"></textarea>
        </p>
        <p>
            <input id="runbutton" type="button" value="Run!">
        </p>
    </form>

    <div id="target" style="--count: 5">
        <div style="--stack: 0; --index: 0;"><span>M</span></div>
        <div style="--stack: 1; --index: 4; --newStack: 0; --newIndex: 2;" class="moving"><span>D</span></div>
        <div style="--stack: 2; --index: 2;"><span>C</span></div>
    </div>

    <hr><!-- just here to visibly see that I set #target's height correctly -->
</body>
